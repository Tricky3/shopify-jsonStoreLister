(function(e){var t;window.SelectBoxManager=function(t){var n=[],r=this;e(document).click(function(t){if(e(t.target).parents(".customSelect").get(0)==null){r.close()}});this.add=function(e){n.push(e)};this.close=function(){e(n).each(function(){this.close()})}};var n=new SelectBoxManager;window.SelectBox=function(t){function m(){var e="";if(typeof i.selectbox.attr("id")!=="undefined"){e='id="select-'+i.selectbox.attr("id")+'"'}i.selectbox.wrap('<div class="customSelect" '+e+" />");s=i.selectbox.parents(".customSelect");l=i.selectbox.find("option");var t=['<div class="selectList"><div class="selectListOuterWrap"><div class="selectListInnerWrap"><div class="selectListTop"></div><dl>'];t.push(w());t.push('</dl><div class="selectListBottom"></div></div></div></div>');s.append('<div class="selectValueWrap"><div class="selectedValue">'+v+'</div> <span class="caret"></span> </div>'+t.join(""));f=s.find("dl");o=s.find(".selectedValue");u=s.find(".selectValueWrap");a=s.find(".selectList");s.width(i.width);f.width(i.width-2);g();n.add(r)}function g(){u.click(function(){if(h){i.selectbox.focus();r.close()}else if(p){if(c){i.selectbox.focus()}else{r.open();i.onOpenCallback()}}});f.click(function(t){var n=e(t.target);if(n.is("dd")||n.parents("dd")){if(t.target.tagName.toLowerCase()!="dd"){n=n.parents("dd")}if(n.get(0)){r.jumpToIndex(n.get(0).className.split(" ")[0].split("-")[1]);r.close();if(!c){i.selectbox.focus()}}}});i.selectbox.focus(function(e){d=true;s.addClass("focused")}).blur(function(e){d=false;s.removeClass("focused")});if(c){i.selectbox.change(function(t){b(e(this).find("option:selected").html())})}i.selectbox.keyup(function(e){r.close();l.each(function(e,t){if(t.selected){r.jumpToIndex(e);return false}})});y()}function y(){var t=e(".customSelect dd");t.off("mouseover");t.off("mouseout");t.on("mouseover",function(t){var n=e(t.target);if(t.target.tagName.toLowerCase()!="dd"){n=n.parents("dd")}n.addClass("hovered")});t.on("mouseout",function(t){var n=e(t.target);if(t.target.tagName.toLowerCase()!="dd"){n=n.parents("dd")}n.removeClass("hovered")})}function b(e){if(o.html()!=e){o.html(S(e));i.changeCallback(i.selectbox.val())}}function w(){var t=[];l.each(function(n,r){var i=e(this);var s=i.parents("optgroup");if(s.length>0&&i.prev().length===0){t.push("<dt>"+s.attr("label")+"</dt>")}var o="";if(r.className!=""){e(r.className.split(" ")).each(function(){o+='<span class="'+this+'"></span>'})}if(r.selected){v=o+S(e(r).html());t.push('<dd class="itm-'+n+' selected">'+o+r.innerHTML+"</dd>")}else{t.push('<dd class="itm-'+n+'">'+o+r.innerHTML+"</dd>")}});if(o&&o.get(0)!=null){o.html(v)}return t.join("")}function E(){f.css("height","auto");if(i.height&&f.height()>i.height){f.css("height",i.height);if(i.customScrollbar){r.scrollpane=f.jScrollPane(e.extend({contentWidth:200},i.scrollOptions))}else{f.addClass("defaultScrollbar")}}else{f.css({overflow:"hidden"})}}function S(e){var t=e.split("</span>");var n=t[t.length-1];t[t.length-1]="";var r=t.join("</SPAN>");return r+i.truncate(n)}var r=this,i=e.extend(true,{manager:n,customScrollbar:true,zIndex:100,changeCallback:function(e){},onOpenCallback:function(){},truncate:function(e){return e},scrollOptions:{}},t);var s,o,u,a,f,l,c=false,h=false,p=true,d=false,v="";this.sync=function(){l=i.selectbox.find("option");f.html(w());y();E()};this.hide=function(){s.addClass("hidden")};this.disable=function(){p=false;s.addClass("disabled");i.selectbox.attr("disabled","disabled")};this.enable=function(){p=true;s.removeClass("disabled");i.selectbox.removeAttr("disabled")};this.close=function(){s.removeClass("select-open");s.css({"z-index":i.zIndex});h=false};this.open=function(){E();if(i.manager){i.manager.close()}s.addClass("select-open");if(r.scrollpane){}s.css({"z-index":i.zIndex+1});h=true};this.jumpToIndex=function(e){i.selectbox.get(0).selectedIndex=e;s.find(".selected").removeClass("selected");s.find(".itm-"+e).addClass("selected");b(s.find(".itm-"+e).html())};this.jumpToValue=function(e){var t=-1;l.each(function(n){if(this.innerHTML==e){t=n;return false}});if(t!=-1){r.jumpToIndex(t)}return t};m()}})(jQuery);